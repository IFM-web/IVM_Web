@{
    @inject Microsoft.AspNetCore.Http.IHttpContextAccessor httpContextAccessor
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]  - IFM360</title>
    
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />  
      <link rel="stylesheet" href="~/css/IFMstyleSheet.css" />
     <link rel="icon" type="image/png" href="~/upload/logo/logo.png">

    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
          integrity="sha512-Avb2QiuDEEvB4bZJYdft2mNjVShBftLdPG8FJ0V7irTLQ8Uo0qcPxh4Plq7G5tGm0rU+1SPhVotteLpBERwTkw=="
          crossorigin="anonymous"
          referrerpolicy="no-referrer" />

<style>
   

       
   </style>
</head>
<body>
    <input type="hidden" id="EmailId" value="@httpContextAccessor.HttpContext.Session.GetString("EmailId")" />
    <input type="hidden" id="Password" value="@httpContextAccessor.HttpContext.Session.GetString("Password")" />
 
    <div class="container-fluid px-0">
        <div class="row gx-0">
            <!-- Add a button for toggling on phones -->
            <button class="btn d-md-none mb-2" onclick="toggleSidebar()" style="width:3rem; color: #1E3A5F; margin:1rem; border:1px solid #1E3A5F">☰</button>

            <div class="col-md-3 mb-md-3">
                <!-- sidebar work -->
                <div id="sidebar" class="sidebar d-none d-md-flex flex-column mb-3" style="overflow-y: auto;
">
                    <button class="btn btn-danger d-md-none mb-2" onclick="toggleSidebar()">X</button>

                    <a href="#" class="d-block text-center mb-3">
                        <img src="~/upload/logo/ifmlogo.png" alt="IFM360" class="img-fluid" style="max-height: 60px;" />
                    </a>
                    <p class="fs-5 fw-semibold m-0 text-center" style="color:darkslateblue"> <i class="fa fa-user"></i> Welcome <span id="visitorName">@httpContextAccessor.HttpContext.Session.GetString("adminname")</span></p>
                    
                    <hr style="height: 2px; background-color: #1E3A5F; border: none;" />
                    <nav class=" flex-grow-1">
                        <a asp-controller="SuperAdmin" class="dropdown-item" asp-action="Home" style="display: block; text-decoration: none;">
                            <i class="fa fa-dashboard"></i>
                            &nbsp; DashBoard
                        </a>
                        <a asp-controller="SuperAdmin" class="dropdown-item" asp-action="ManageOfficesList" style="display: block; text-decoration: none;">
                            <i class="fa fa-building"></i> &nbsp;
                            Manage Offices
                        </a>
                        <a asp-controller="SuperAdmin" class="dropdown-item" asp-action="Department" style="display: block; text-decoration: none;">
                            <i class="fa fa-paw"></i> &nbsp;
                           Manage Department
                        </a>
                        <a asp-controller="SuperAdmin" class="dropdown-item" asp-action="EmployeeList" style="display: block; text-decoration: none;">
                            <i class="fa fa-users"></i> &nbsp;
                            Manage Employees
                        </a>
                        <a asp-controller="SuperAdmin" class="dropdown-item" asp-action="ManageVisitorType" style="display: block; text-decoration: none;">
                            <i class="fa fa-circle"></i> &nbsp;
                            Manage Visitor Type
                        </a>
                        <a asp-controller="SuperAdmin" class="dropdown-item" asp-action="ManageNotifications" style="display: block; text-decoration: none;">
                            <i class="fa fa-commenting"></i> &nbsp;
                            Manage Notifications
                        </a>
                        <a asp-controller="SuperAdmin" class="dropdown-item" asp-action="AdminVisitorHistory" style="display: block; text-decoration: none;">
                            <i class="fa fa-history "></i> &nbsp;
                            Visitor History
                        </a>
                        <a asp-controller="SuperAdmin" class="dropdown-item" asp-action="PreInviteVisitor" style="display: block; text-decoration: none;">
                            <i class="fa fa-clock"></i> &nbsp;
                            Pre Invite Visitors
                        </a>
                        <a asp-controller="SuperAdmin" class="dropdown-item" asp-action="Report" style="display: block; text-decoration: none;">
                            <i class="fa fa-building "></i> &nbsp;
                            Report
                        </a>
                    



                       

                        <a asp-controller="Home" asp-action="Login" class="d-block text-decoration-none mt-auto "><i class="fa-solid fa-power-off"></i> &nbsp; Logout</a>
                    </nav>
                 
                </div>
            </div>
            <div class="col-md-9">
    <div class="container">

                    <div id="loader" class="loader-overlay">
                        <div class="spinner"></div>
                    </div>
        <main role="main" class="pb-3">
                        <input type="hidden" id="EmailId" value="@httpContextAccessor.HttpContext.Session.GetString("EmpEmailId")" />
                        <input type="hidden" id="LocationID" value="@httpContextAccessor.HttpContext.Session.GetString("location_id")" />
                        <input type="hidden" id="Password" value="@httpContextAccessor.HttpContext.Session.GetString("Password")" />
            @RenderBody()
        </main>
    </div>
    </div>
    </div>
    </div>


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    @await RenderSectionAsync("Scripts", required: false)
    <script>
     function toggleDropdown(event) {
         document.querySelectorAll(".dropdown-items").forEach(link => {
             console.log(link)
           link.style.display = "none";
        });

         const toggle = event.currentTarget; // <a> tag
         const dropdown = toggle.nextElementSibling; // <ul> element
         const arrowIcon = toggle.querySelector('.dropdown-arrow'); // <i class="dropdown-arrow">
 
         // Toggle dropdown visibility
         if (dropdown.style.display === "block") {
             dropdown.style.display = "none";
             toggle.classList.remove("open");
         } else {
             dropdown.style.display = "block";
             toggle.classList.add("open");
         }
 
         // Toggle arrow rotation (handled by CSS)
         if (arrowIcon) {
             arrowIcon.classList.toggle("rotate-up");
         }
     }

       
        document.addEventListener("DOMContentLoaded", function () {
            let currentUrl = window.location.pathname.toLowerCase();

            document.querySelectorAll(".sidebar-link, .dropdown-item").forEach(link => {
                let href = link.getAttribute("href")?.toLowerCase();

                if (href && currentUrl.includes(href)) {
                    link.classList.add("active");

                    
                    let parentDropdown = link.closest(".dropdown-items");
                    if (parentDropdown) {
                        parentDropdown.style.display = "block";
                    }
                }
            });
        });


</script>
</body>
</html>
